define(["jquery","core/ajax","core/notification","core/str","core/modal_factory","core/modal_events"],function(a,b,c,d,e,f){var g,h,i,j,k={HEADER:"#page-header .header-body",HEADER_TOP:"#page-header .page-head",HDRSTYLEA_BTN:"#hdr_chooser_a",HDRSTYLEB_BTN:"#hdr_chooser_b"},l=function(b,c,d){g=a(b),h=c,i=d},m=function(){g.on("click",k.HDRSTYLEA_BTN,n),g.on("click",k.HDRSTYLEB_BTN,n)},n=function(){j=a(this),e.create({type:e.types.SAVE_CANCEL,title:"Change Style",body:"Are you sure you want to change the header style?"}).then(function(a){a.setSaveButtonText("Change");var b=a.getRoot();b.on(f.cancel,function(){}),b.on(f.save,o),a.show()})},o=function(){if(a(k.HDRSTYLEA_BTN+", "+k.HDRSTYLEB_BTN).removeClass("selected"),_changed=1,"#"+j.attr("id")==k.HDRSTYLEB_BTN){if(i=1,a(k.HDRSTYLEB_BTN).addClass("selected"),bkgimg=a("#hdr_chooser_a_div img").attr("src"),!bkgimg)return;a("#hdr_chooser_a_div").remove(),a("#hdr_chooser_b_div").removeClass("style-a");var d={"background-image":"url("+bkgimg+")","background-size":"100%","background-position":"center"};a("#hdr_chooser_b_div").css(d)}else{if(i=0,a(k.HDRSTYLEA_BTN).addClass("selected"),bkgimg=a("#hdr_chooser_b_div").css("background-image"),"none"===bkgimg)return;bkgimg=bkgimg.substring(5,bkgimg.length-2),a("#hdr_chooser_b_div").css("background-image",""),a("#hdr_chooser_b_div").addClass("style-a"),a("#header_a_head").prepend('<div id="hdr_chooser_a_div" class="course-image"><img src="'+bkgimg+'" height="300" width="300" /></div>')}if(h){var e={courseid:h,headerstyle:i},f={methodname:"theme_urcourses_default_header_choose_style",args:e,done:p,fail:c.exception};b.call([f])}},p=function(){d.get_string("success:coursestylechosen","theme_urcourses_default").done(q)},q=function(b){var c=a("<div></div>");c.text(b),c.css({position:"absolute"}),c.css({right:"5px"}),c.css({"z-index":"1200"}),c.addClass("alert alert-success alert-dismissable fade show");var d=a("<button></button>");d.html("&times;"),d.addClass("close"),d.attr("type","button"),d.attr("data-dismiss","alert"),c.append(d),a(k.HEADER_TOP).append(c),setTimeout(function(){a("div.alert.alert-success.alert-dismissable.fade.show").alert("close")},1800)},r=function(a,b,c){l(a,b,c),m()};return{init:r}});